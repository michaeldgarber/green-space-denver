---
title: "Preliminary NDVI analyses, Denver area"
author: "Michael D Garber"
date: "February 2, 2022"
---

This document presents some preliminary analyses characterizing the NDVI of certain places and census tracts throughout the Denver area.

First, load packages used in this Rmarkdown doc.
```{r loadpackages, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE}
library(here)
library(tidyverse)
library(sf)
library(terra)
library(mapview)
library(mapview)
library(knitr)
```

# NDVI for the Denver area, 2016-2021
We obtained the normalized difference vegetation index (NDVI) from the Landsat-8 satellite at a resolution of 30 meters squared at a roughly 15-day interval between 2016 and 2021 for the following area around Denver:
```{r denverbbox, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE}
setwd(here("data-processed"))
load("den_metro_bbox.RData")
den_metro_bbox %>% mapview(layer.name = "Study area")
```

We gathered this data using the [rgee package](https://cran.r-project.org/web/packages/rgee/index.html), an R package that facilitates connection to the Google Earth Engine via Python. Please see these two scripts for specific details on the process for gathering and processing the NDVI data in this area:
https://github.com/michaeldgarber/green-space-denver/blob/main/scripts/1a_get_landsat_ndvi_denver.R
https://github.com/michaeldgarber/green-space-denver/blob/main/scripts/1b_wrangle_check_landsat_ndvi_denver.R

Here is the NDVI over the study area on a cloud-free day, July 4, 2021:
```{r terragoodmo, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE, cache = TRUE}
setwd(here("data-processed"))
ndvi_den_metro_terr_5_yr = terra::rast("ndvi_den_metro_terr_5_yr.tif")
mv_good_date =ndvi_den_metro_terr_5_yr$`20210704_NDVI` %>% 
  raster::raster() %>%  
  mapview(layer.name = "NDVI, July 4, 2021")
mv_good_date
```


# Characterize NDVI of places of interest


Load data. Note data are created in this folder: https://github.com/michaeldgarber/green-space-denver/tree/main/scripts
```{r loaddata, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE}
setwd(here("data-processed"))
load("places_native_geo.RData")
load("places_native_nogeo.RData")
```

Print information about the places of interest, including approximate percent nativity where available.
```{r printtibble, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE, results = 'asis'}
places_native_nogeo %>% 
  dplyr::select(place_name, native_percent, place_type, place_id) %>% 
  kable()
```

Map these places by type (nativity spectrum or high-plant diversity).
```{r mapview, eval=TRUE, echo=TRUE, warning=FALSE, message=FALSE}
places_native_geo %>% 
  mapview(zcol = "place_type",
          layer.name = "Place category")
```
